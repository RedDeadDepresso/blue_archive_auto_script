# 如何使用

## 一些关键的设置

### 模拟器设置
- 分辨率: 我们极力推荐你使用**1280x720**尺寸

### 游戏内设置
- 记忆大厅：请勿选取亚子，爱露, 若藻等角色, 推荐**关闭记忆大厅**
- 国际服语言：支持**英文/繁体中文/韩文**
- 游戏内设置

| 名称       | 选项      |
|----------|---------|
| 分辨率      | 60      |
| 加速渲染模式   | 兼容      |
| 后期处理     | ON      |
| 抗锯齿      | ON      |
| 战斗画面上下黑边 | **OFF** |

### 汉化补丁
:::warning
游戏汉化修改游戏中图像, 导致**BAAS**无法进行模版匹配

**请勿使用任何形式的汉化补丁**
:::

### 反和谐
1. 反和谐仅在国服存在, 反和谐前后一些角色的立绘, 以及一些文字内容会有所不同
2. **BAAS**在反和谐前 / 后均可正常使用
3. **BAAS**支持一键反和谐, 仅需打开模拟器后点击UI中的一键反和谐按钮即可
    - ![anti-harmony](/assets/config/anti-harmony.png)
## 脚本参数填写帮助
### 咖啡厅
#### 如何设置咖啡厅邀请券为指定角色
1. 选择邀请模式为```邀请收藏的学生```, 序号为```1```
2. 收藏且仅收藏指定角色
**related issue**: [#211](https://github.com/pur1fying/blue_archive_auto_script/issues/211), [#148](https://github.com/pur1fying/blue_archive_auto_script/issues/148)
#### 如何设置BAAS咖啡厅一日摸8次指定角色
1. 首先按照上一级标题所述, 设置1号和2号咖啡厅邀请券为该角色
2. **关闭**咖啡厅设置中的**使用邀请券**
3. **开启**调度中的**1号咖啡厅邀请** 和 **2号咖啡厅邀请**

**note**: 
1. 最终效果为BAAS将在以下时间摸头(国服为例): 
   - 4:00(使用1号咖啡厅邀请券)
   - 7:00
   - 10:00
   - 13:00
   - 16:00(使用2号咖啡厅邀请券)
   - 19:00
   - 22:00
   - 1:00

2. 相关issue: [#252](https://github.com/pur1fying/blue_archive_auto_script/issues/252)

### 日程
#### 如何设置BAAS做指定角色日程
1. 开启选项```优先做指定角色存在的日程```
2. 在 ```src/images/你的服务器/lesson_affection``` 目录下检索对应学生的模板图像, 复制文件名填入```指定角色```配置
3. 如果没有收录你想要的角色的模板, 你需要向开发者提供以下截图
    1. 模拟器1280x720分辨率
    2. 图像是无损的(png)
    3. 日程界面中有指定角色
    4. 需要手动滑向上滑一下界面, 使图像包含九个区域角色头像
    5. 等待开发者适配
    - 例(假设提供星野的模板): ![image](/assets/config/lesson_affection_example.png)

### 制造
#### 如何设置BAAS制造指定角色喜欢的礼物
1. 制造级数至少为2级(只有二级可以指定)
2. 在二级制造配置中```一键设置推荐优先级```选择该角色

### 主线剧情
- 自动推剧情可以完成所有**走格子** 但是最终章一些战斗无法自动打
- 数字与章节对应表:

| 数字 | 对应章节     |
|----|----------|
| 1  | 序章（仅日服有） |
| 2  | 第一章      |
| 3  | 第二章      |
| 4  | 第三章      |
| 5  | 第四章      |
| 6  | 最终章      |
| 7  | 第五章      |
| 8  | EX章节     |

填写:
用","隔开数字表示依次要推的章节

- **example:**

| 填写参数  | BAAS执行         |
|-------|----------------|
| 1,3,6 | 依次推第一章，第三章，最终章 |
- **note:** 什么都不填会用默认配置

| 服务器 | 默认配置             |
|-----|------------------|
| 国服  | 2,3,4,5,6        |
| 国际服 | 2,3,4,5,6,7      |
| 日服  | 1,2,3,4,5,6,7,8） |

### 普通图自动推图
- 使用说明:
1. 必须解锁自动结束回合和自动战斗
2. 支持的关卡: 区域4 至 最新区域
3. 每次游戏更新新区域时**BAAS**会在当天更新最新区域的自动推图
4. **BAAS**推图时队伍移动点击坐标和路线是固定的，且所有移动只会点击一次，由于碧蓝档案游戏推图时若有多支队伍，则会根据队伍在游戏内编号大小坐标和移动次序不同。
5. 由于4，自动推图时必须保证选择队的伍编号由小到大 。
6. [**小春版配队指南**](#小春版配队指南)
7. **BAAS会**根据**普通图推图设置**中[队伍属性配置](#各图所需属性)和[选队逻辑](#选队逻辑)寻找合适配置进行推图

#### 选队逻辑:
1. 当选队逻辑选项为 `"预设编队"`时: 
    - **BAAS**会根据需要属性的预设队伍进行选队, 你需要设置游戏中五行四列的预设是**爆发, 贯穿, 神秘, 振动, 未使用**中的哪一种
    - 你需要人为保证所选择的队伍不会有角色冲突
    - 当所需属性队伍数量不够时, 会按克制顺序依次尝试其他队伍
    **note**: 此模式下不可以修改预设名称
2. 当选队伍逻辑选项为 `"按侧栏属性编队"`时:
    - 按照需要属性由小到大选择队伍
    - 优先保证boss队的克制属性, 按克制顺序依次尝试队伍
3. 当选队伍逻辑选项为`"按侧栏顺序编队"`, 依次选择侧栏1, 2, 3, 4队

#### 小春版配队指南
将选队逻辑选项选择`"按侧栏顺序编队"`, 按照[队伍属性配置](#各图所需属性)设置游戏内队伍

例:
    
   | 关卡     | 游戏内配队                   |
   |--------|-------------------------|
   | 普通图20图 | 队伍1配为爆发, 队伍2为贯穿         |
   | 困难图20图 | 队伍1配为爆发, 队伍2为贯穿, 队伍3为爆发 |

### 普通图推图关卡填写说明
1. 输入一个数字表示推该区域所有关卡一次
2. 输入 数字-数字表示指定关卡
3. **BAAS** 会自动检测关卡的**sss**, **完成挑战任务**情况, 跳过已经完成的关卡, 不会有额外体力消耗
4. 例:

   | 填写      | BAAS                             |
   |---------|----------------------------------|
   | 15,16-3 | 依次打15-1,15-2,15-3,15-4,15-5,16-3 |

**note:** 
1. [各区域所需属性](#各图所需属性)

### 普通图扫荡填写说明
1. 每条扫荡配置形如 ```region```-```task number```-```sweep times```

    | 名称          | 含义   | 限制      |
    |-------------|------|---------|
    | region      | 区域   | 4-最新章节  |
    | task number | 关卡   | 1-5     |
    | sweep times | 扫荡次数 | 正整数/max |

2. 每条配置都用```","``` 隔开
3. 可用扫荡关卡:
教程-1与5图后 所有地图
4. 特殊说明
- ```sweep times``` 可以为 ```max```
- 教程需要```region```为固定字符串```tutorial```, 且仅可扫荡教程1, 用于使用最少的**20体力**完成**20次普通关卡**的任务
- BAAS会根据当前体力和关卡体力计算当前关卡能否扫荡，不足或扫荡完次数为```max```的关卡会直接退出

例:

| 填写                            | BAAS                                  |
|-------------------------------|---------------------------------------|
| tutorial-1-20,15-3-3,20-3-max | 先打教程-1 20次,然后扫荡15-3,3次,然后使用所有体力扫荡20-3 |
### 困难图推图关卡填写说明

1. 格式同[普通图推图关卡填写说明](#普通图推图关卡填写说明)
2. **BAAS**会自动检测关卡的 **sss**, **领取礼物**, **完成挑战任务**情况, 跳过已经完成的关卡,不会有额外体力消耗

   | 填写      | BAAS                        |
      |---------|-----------------------------|
   | 15,16-3 | 依次完成H15-1,H15-2,H15-3,H16-3 |
**note**: 
1. 一些困难图需要三支队伍, 第三支队伍的属性均与该区域所需属性的第一个属性相同

### 困难图扫荡填写说明
1. 每条扫荡配置形如 ```region```-```task number```-```sweep times```
    
    | 名称          | 含义   | 限制      |
    |-------------|------|---------|
    | region      | 区域   | 1-最新章节  |
    | task number | 关卡   | 1-5     |
    | sweep times | 扫荡次数 | 正整数/max |
2. 每条配置都用```","``` 隔开
3. 特殊说明
- ```sweep times``` 可以为 ```max```
- BAAS会根据当前体力和关卡体力计算当前关卡能否扫荡, 不足会直接退出。
- 遇到**扫荡次数不足**的关卡会**跳过**, 不会=**购买更多扫荡次数**

### 各图所需属性

| 区域 | 属性     |
|----|--------|
| 28 | 爆发, 振动 |
| 27 | 贯穿, 爆发 |
| 26 | 神秘, 爆发 |
| 25 | 振动, 贯穿 |
| 24 | 振动, 爆发 |
| 23 | 爆发, 贯穿 |
| 22 | 贯穿, 神秘 |
| 21 | 神秘, 爆发 |
| 20 | 爆发, 贯穿 |
| 19 | 贯穿, 神秘 |
| 18 | 神秘, 爆发 |
| 17 | 爆发, 贯穿 |
| 16 | 贯穿, 神秘 |
| 15 | 神秘, 神秘 |
| 14 | 爆发, 神秘 |
| 13 | 贯穿, 贯穿 |
| 12 | 神秘, 爆发 |
| 11 | 贯穿, 神秘 |
| 10 | 爆发, 神秘 |
| 9  | 爆发, 贯穿 |
| 8  | 贯穿, 贯穿 |
| 7  | 爆发, 爆发 |
| 6  | 贯穿, 贯穿 |
| 5  | 爆发     |
| 4  | 贯穿     |
| 3  | 贯穿     |
| 2  | 爆发     |
| 1  | 爆发     |

### 活动图扫荡填写说明
1. 每条扫荡配置由 ```task number``` , ```sweep times```构成, 所有扫荡关卡和次数分别用```","```。即扫荡关卡为```[关卡1, 关卡2, ...]```，扫荡次数为```[关卡1次数, 关卡2次数, ...]```

   | 名称          | 含义   | 限制        |
   |-------------|------|-----------|
   | task number | 关卡   | 1-12      |
   | sweep times | 扫荡次数 | 正整数/小数/分数 |
2. 扫荡次数: 
- 正整数 表示扫荡次数
- 小数 0.5 表示使用当前 体力*0.5 的 体力扫荡该关卡
- 分数 1/3 表示使用当前体力的1/3扫荡该关卡
- 当活动关卡扫荡次数设置为-1时，将可用体力平均分配至所选的多个关卡，并尽可能用尽所有体力。

例:

- 设体力: 999

| 扫荡关卡    | 扫荡次数      | BAAS                       |
|---------|-----------|----------------------------|
| 9,10,11 | 0.5,3,1/3 | 扫荡第9关25次, 第10关3次, 第11关16次  |

计算:
- (999 * 0.5) / 20 = 25次
- (999 * 1/3）/ 20 = 16次

| 扫荡关卡    | 扫荡次数 | BAAS                       |
|---------|------|----------------------------|
| 9,10,11 | -1   | 分别扫荡第9, 10, 11关16次(均摊体力扫荡) |

**note:** BA通常活动关扫荡一次体力消耗:

| 关卡     | 体力消耗 |
|--------|------|
| 1 - 4  | 10   |
| 5 - 8  | 15   |
| 9 - 12 | 20   |

### 调度配置
1. 优先级:当有多于两个任务在队列中时，会优先做优先级小的任务
2. 执行间隔:整数 0 表示间隔一天，
3. 每日重置:
    - 每天固定在这些时间做对应任务(可以有多个时间戳，```","```隔开)
    填写格式 ```[[h, m, s]]``` （UTC时间）
    例：
   
      | 每日重置                          | BAAS                      |
      |-------------------------------|---------------------------|
      | ```[[0, 0, 0], [20, 0, 0]]``` | 北京时间(UTC + 8)8点,4点固定执行该任务 |

4. 禁用时间段:
   - 在所有禁用时间段不做该任务 （可以有多个时间段,```","```隔开）
    填写格式  ```[[[h1, m1, s1], [h2, m2, s1]]]``` (UTC时间)
    例：   
   
    | 每日重置                            | BAAS   |
    |---------------------------------|--------|
    | ```[[[0, 0, 0], [24, 0, 0]]]``` | 表示全天不做 |

5. 前置任务
    - 在执行该任务前依次执行前置任务里所有任务, 不会递归执行前置任务的前置任务
6. 后置任务
    - 在执行该任务后依次执行后置任务里所有任务

### 推送设置
- **serverchan：填写ServerChan提供的SendKey**
- **json：填写自定义的完整地址（如```http://127.0.0.1:8081/```）**
- **推送的json格式为:**
  ```{"title":"Baas Error","desp":"error..."}```


## 其他实用设置

### 尽可能多获取指定角色好感
1. 角色好感度获取方法:
- 咖啡厅摸头(保底一日8次) [设置方式](#如何设置baas咖啡厅一日摸8次指定角色)
- 做指定角色的日程 [设置方式](#如何设置baas做指定角色日程)
- 制造角色喜欢的礼物 [设置方式](#如何设置baas制造指定角色喜欢的礼物)
